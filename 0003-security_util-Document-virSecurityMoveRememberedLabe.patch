From: Michal Privoznik <mprivozn@redhat.com>
Date: Mon, 2 Sep 2019 13:25:11 +0200
Subject: [PATCH] security_util: Document virSecurityMoveRememberedLabel

Signed-off-by: Michal Privoznik <mprivozn@redhat.com>
Reviewed-by: Jiri Denemark <jdenemar@redhat.com>
(cherry picked from commit 359c7c1e94e0c54bf7e7a5a8365f066904b4387b)

Resolves: https://bugzilla.redhat.com/show_bug.cgi?id=1740024

Signed-off-by: Michal Privoznik <mprivozn@redhat.com>
---
 src/security/security_util.c | 13 +++++++++++++
 1 file changed, 13 insertions(+)

diff --git a/src/security/security_util.c b/src/security/security_util.c
index 04347f51e5..365b2dd2d6 100644
--- a/src/security/security_util.c
+++ b/src/security/security_util.c
@@ -244,6 +244,19 @@ virSecuritySetRememberedLabel(const char *name,
 }
 
 
+/**
+ * virSecurityMoveRememberedLabel:
+ * @name: security driver name
+ * @src: source file
+ * @dst: destination file
+ *
+ * For given security driver @name, move all XATTRs related to seclabel
+ * remembering from @src to @dst. However, if @dst is NULL, then XATTRs
+ * are just removed from @src.
+ *
+ * Returns: 0 on success,
+ *         -1 otherwise.
+ */
 int
 virSecurityMoveRememberedLabel(const char *name,
                                const char *src,
